<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Django-EasyRest by suneel0101</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Django-EasyRest</h1>
        <p class="header">an ultra-lightweight read-only REST api framework for Django</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/suneel0101/django-easyrest/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/suneel0101/django-easyrest/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/suneel0101/django-easyrest">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/suneel0101">suneel0101</a></p>


      </header>
      <section>
        <p><a href="https://travis-ci.org/suneel0101/django-easyrest"><img src="https://travis-ci.org/suneel0101/django-easyrest.png" alt="Build Status"></a></p>

<h1>Django-EasyRest</h1>

<p>EasyRest is an ultra-lightweight (160 LOC) read-only REST api framework for Django.</p>

<h1>Table of Contents</h1>

<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#when-should-i-use-easyrest">When should I use EasyRest?</a></li>
<li>
<a href="#usage">Usage</a>

<ul>
<li><a href="#declare-a-resource">Declare a Resource</a></li>
<li><a href="#define-get-queryset">Define get_queryset</a></li>
<li><a href="#search">Search</a></li>
<li><a href="#register-the-resource-with-the-api">Register the Resource with the API</a></li>
<li><a href="#url-endpoints">URL Endpoints</a></li>
<li><a href="#format-of-requests-and-responses">Format of Requests and Responses</a></li>
<li><a href="#pagination">Pagination</a></li>
<li><a href="#authorization">Authorization</a></li>
<li><a href="#builtin-apikey-authorization-system">Builtin APIKey Authorization System</a></li>
<li><a href="#authorization-helpers">Authorization Helpers</a></li>
<li><a href="#restrict-results-by-user">Restrict Results by User</a></li>
</ul>
</li>
<li><a href="#bend-easyrest-to-your-will">Bend EasyRest to Your Will</a></li>
<li><a href="#how-to-hack-on-easyrest">How to Hack on EasyRest</a></li>
<li><a href="#roadmap">Roadmap</a></li>
<li><a href="#license">License</a></li>
</ul><h1>Installation<a name="installation"> </a>
</h1>

<pre><code>pip install django-easyrest
</code></pre>

<h1>Example<a name="example"> </a>
</h1>

<div class="highlight"><pre><span class="c"># api.py</span>

<span class="kn">from</span> <span class="nn">easyrest</span> <span class="kn">import</span> <span class="n">API</span><span class="p">,</span> <span class="n">APIResource</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Item</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">API</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">ItemResource</span><span class="p">(</span><span class="n">APIResource</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Item</span>  <span class="c"># the model class you want to expose via the API</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'item'</span>  <span class="c"># name of resource in the url: '/api/{{ name }}/'.</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s">'text'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="s">'popularity'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">popularity</span><span class="p">,</span>
        <span class="p">}</span>

<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ItemResource</span><span class="p">)</span>

<span class="c"># urls.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">.api</span> <span class="kn">import</span> <span class="n">api</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">url</span><span class="p">(</span><span class="s">r'^api/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">get_urls</span><span class="p">())))</span>
</pre></div>

<h1>Features<a name="features"> </a>
</h1>

<p>EasyRest is meant to be simple and cover the most common use cases. So it supports,</p>

<ul>
<li>search</li>
<li>pagination</li>
<li>authentication</li>
<li>restricting by owner</li>
</ul><h1>When should I use EasyRest?<a name="when-should-i-use-easyrest"> </a>
</h1>

<ul>
<li>When you need a simple read-only REST API for your own Backbone/Ember/Angular app</li>
<li>When you need a read-only API for others to consume - EasyRest has a simple and extensible authorization system.</li>
<li>Whenever you want!</li>
</ul><h1>Usage<a name="usage"> </a>
</h1>

<h2>Declare a Resource<a name="declare-a-resource"> </a>
</h2>

<p>You only need to specify 3 things when subclassing APIResource:</p>

<ol>
<li>
<code>model</code>: the Django model you're exposing through the API</li>
<li>
<code>name</code>: this is the name of resource in the url: '/api/{{ name }}/'. If you don't set it, it will fallback to the Model.meta.db_table</li>
<li>
<code>serialize</code> method: returns a serialized version of an instance of your Model, however you want it to. You can reference properties and whatever else. You're not just limited to the model fields.</li>
</ol><p>If you want to customize the list of results returned by the list endpoint, you should modify the the <code>get_queryset</code> method as shown below.</p>

<h2>Define <code>get_queryset</code><a name="define-get-queryset"> </a>
</h2>

<p><code>get_queryset</code> returns the base results for the resource. It defaults to the following:</p>

<div class="highlight"><pre><span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_params</span><span class="p">):</span>
    <span class="c"># get_params is request.GET.dict()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

<p>Modify it however you like.</p>

<p>So if you wanted to have the queryset ordered by <code>id</code> descending and <code>status &gt; 7</code>, you would add to the above <code>ItemResource</code> the following method:</p>

<div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">status__gt</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-id'</span><span class="p">)</span>
</pre></div>

<h2>Search: use <code>get_queryset</code><a name="search"> </a>
</h2>

<p>Sometimes you might want to allow your API user to search for a result set rather than just listing the results in a certain order.</p>

<p>The way to set this up in EasyRest is intentionally very barebones so you can extend it and implement the search you want for your resource, no matter how simple or complicated.</p>

<h4>All you have to do is modify the <code>get_queryset</code> method</h4>

<div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Some custom search logic.</span>
<span class="sd">        You always have access to the request.GET params</span>
<span class="sd">        through `get_params`</span>
<span class="sd">        """</span>
        <span class="n">base_queryset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">filter_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">get_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"popular"</span><span class="p">):</span>
            <span class="n">filter_kwargs</span><span class="p">[</span><span class="s">"status__gte"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>

        <span class="k">if</span> <span class="n">get_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"contains"</span><span class="p">):</span>
            <span class="n">filter_kwargs</span><span class="p">[</span><span class="s">"text__icontains"</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">[</span><span class="s">"contains"</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">base_queryset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">filter_kwargs</span><span class="p">)</span>
</pre></div>

<p>The important thing here is you can plug in whatever search system you want. You're not even tied to SQL or the Django ORM. You can use ElasticSearch or whatever backend makes sense for your use case.</p>

<h4>What is the URL endpoint for a search request?</h4>

<p>The URL endpoint for the search request is the same as in list resource request. So if in your root urlconf, you register the api to "/api" and your resource name is "book", you would make the request to <code>/api/book/</code></p>

<p>See <a href="#format-of-requests-and-responses">Format of Requests and Responses</a></p>

<h4>What does a search request to the API look like?</h4>

<p>The format of the request will depend on how you implement the <code>get_queryset</code> method, but in this case, it looks like this:</p>

<p><code>GET /api/searchable_item/?popular=1&amp;contains=fun</code></p>

<h2>Register the Resource with the API<a name="register-the-resource-with-the-api"> </a>
</h2>

<ul>
<li>Create an instance of <code>easyrest.API</code>
</li>
<li>Then register your resource: <code>api.register(MyResource)</code>
</li>
<li>Then include <code>api.get_urls</code> in your urlconf</li>
</ul><p>Note that because you are registering resources with an instance of <code>easyrest.API</code>, you can conceivably have many different API instances with different resources. EasyRest is flexible in how you use it.</p>

<h2>URL Endpoints<a name="url-endpoints"> </a>
</h2>

<p>For each resource you register, there are two URL endpoints: the list endpoint and the item endpoint.
The list endpoint returns a list of instances.
The item endpoint returns a single instance.</p>

<p>Let's use the example of ItemResource above.
We named the resource "item" and included the api urls behind the prefix "/api".
So, the urls generated are:</p>

<ul>
<li>
<code>/api/item/</code> - This returns a list of Items</li>
<li>
<code>/api/item/{int: id}/</code> - This returns a single serialized Item with the specified id</li>
</ul><h2>Format of Requests and Responses<a name="format-of-requests-and-responses"> </a>
</h2>

<h4>GET to the Item list endpoint</h4>

<div class="highlight"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">item</span><span class="o">/</span> <span class="mi">200</span>

<span class="p">{</span>
   <span class="s">"items"</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s">"id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s">"name"</span><span class="p">:</span> <span class="s">"Louis CK"</span>
           <span class="s">"text"</span><span class="p">:</span> <span class="s">"I'm a hilarious comedian"</span><span class="p">,</span>
           <span class="s">"popularity"</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="p">{</span>
           <span class="s">"id"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
           <span class="s">"name"</span><span class="p">:</span> <span class="s">"Joffrey Lannister"</span><span class="p">,</span>
           <span class="s">"text"</span><span class="p">:</span> <span class="s">"I'm troubled."</span><span class="p">,</span>
           <span class="s">"popularity"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
       <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<h4>GET to the Item single-item endpoint</h4>

<div class="highlight"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">item</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span> <span class="mi">200</span>

<span class="p">{</span>
    <span class="s">"id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Louis CK"</span>
    <span class="s">"text"</span><span class="p">:</span> <span class="s">"I'm a hilarious comedian"</span><span class="p">,</span>
    <span class="s">"popularity"</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

<h4>GET to the Item single-item endpoint for a nonexistent item</h4>

<div class="highlight"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">item</span><span class="o">/</span><span class="mi">9998</span><span class="o">/</span> <span class="mi">400</span>

<span class="p">{</span>
    <span class="s">"error"</span><span class="p">:</span> <span class="s">"No result found matching id: 9998"</span>
<span class="p">}</span>
</pre></div>

<h2>Pagination<a name="pagination"> </a>
</h2>

<p>If you want to paginate the results, you just need to set <code>results_per_page</code>. Here's an example:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">PaginatedItemResource</span><span class="p">(</span><span class="n">APIResource</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Item</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'paginated_item'</span>
    <span class="n">results_per_page</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s">'text'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="s">'popularity'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">popularity</span><span class="p">,</span>
        <span class="p">}</span>
</pre></div>

<p>If you don't set <code>results_per_page</code>, all of the items will be returned at once.</p>

<h4>How do I request a paginated resource?</h4>

<p>Simple.</p>

<pre><code>GET /api/paginated_item/?page=2
</code></pre>

<h2>Authorization<a name="authorization"> </a>
</h2>

<p>EasyRest authorization is really easy to use and extend, as you'll see below.</p>

<h4>1. Define an authorization scheme</h4>

<p>Decide whether you want your API consumer to pass in an API key through the request GET parameters or the headers or whatever else.</p>

<h4>2. Set <code>needs_authorization = True</code> in your resource declaration</h4>

<h4>3. Define an <code>authorize</code> method for your resource</h4>

<p>Here's an example:</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">resteasy</span> <span class="kn">import</span> <span class="n">APIResource</span>
<span class="kn">from</span> <span class="nn">resteasy.auth</span> <span class="kn">import</span> <span class="n">get_user_from_GET_param</span>

<span class="k">class</span> <span class="nc">AuthorizedItemResource</span><span class="p">(</span><span class="n">APIResource</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">UserItem</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'authorized_item'</span>
    <span class="n">needs_authorization</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'name'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s">'user_id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">authorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        I find the user based on the value of `apikey`</span>
<span class="sd">        being passed in as a GET parameter.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">get_user_from_GET_param</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"apikey"</span><span class="p">)</span>
</pre></div>

<h4>Advice on many resources sharing same authorization scheme</h4>

<p>Often you may want the same authorization method for many of your resources.
In that case, you should subclass APIResource.</p>

<p>Let's call the new class AuthorizedAPIResource.
Define the <code>authorize</code> method of AuthorizedAPIResource and then have your model resources inherit from AuthorizedAPIResource</p>

<h4>What does an example request with authorization look like?</h4>

<p>This will depend on authorization scheme, but in the above case where we pass in the apikey in the get request, it would look like this:</p>

<div class="highlight"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">authorized_item</span><span class="o">/</span><span class="err">?</span><span class="n">apikey</span><span class="o">=</span><span class="n">kjhsdf3</span>
</pre></div>

<h2>Builtin APIKey Authorization System<a name="builtin-apikey-authorization-system"> </a>
</h2>

<p>For your convenience, in <code>easyrest.models</code>, there is a simple APIKey model linked to a User.
The <code>easyrest.auth</code> methods use this model. </p>

<p>Creating APIKeys for your consumers is very straightforward. For example,</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">easyrest.models</span> <span class="kn">import</span> <span class="n">APIKey</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'tester'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">'123'</span><span class="p">)</span>
<span class="n">new_api_key</span> <span class="o">=</span> <span class="n">APIKey</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</pre></div>

<h2>Authorization helpers<a name="authorization-helpers"> </a>
</h2>

<p>In easyrest.auth, there are three really useful helper methods:</p>

<ol>
<li>
<code>get_user_from_GET_param(request, param_name)</code>: extracts API key from the request GET parameter <code>param_name</code> and returns the user who owns that API key.</li>
<li>
<code>get_user_from_request_header</code>: does the same but from the request header</li>
<li>
<code>get_user_from_request</code>: returns <code>request.user</code> if the user is authenticated</li>
</ol><p>These are by no means exhaustive, but they do cover a lot of the ways in which you'll want you're API consumers to authenticate.</p>

<p>If you want to use your own way of authenticating, just write your own <code>authorize</code> method, and you're good.</p>

<h4>What happens if an unauthorized person tries to access a protected resource?</h4>

<p>If someone tries to access a resource without authorization, they will get a 403 Forbidden response.</p>

<h2>Restrict Results by User<a name="restrict-results-by-user"> </a>
</h2>

<p>A lot of the time, we want our API consumers to only access the results that they own.</p>

<p>Imagine an API you can use to get all your Bank Transactions. You want some way of limiting the API user to only retrieving their own bank transactions, so they don't have access to everyone's bank transactions.</p>

<p>To achieve this, you just need to do 1 thing in addition to setting up Authorization as above.</p>

<h4>Set <code>user_field_to_restrict_by</code>
</h4>

<p>When you declare your resource, you should set <code>user_field_to_restrict_by</code> equal to the User field that owns the resource.
This field the same path you would use through the Django Queryset API.</p>

<p>Here are two examples, one simple and one a bit more complicated.</p>

<p>If your UserItem is linked to a User through the field "user",</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">UserItem</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">boss</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">'auth.User'</span><span class="p">)</span>
    <span class="n">is_active</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

<p>You should set <code>user_field_to_restrict_by="boss"</code> as follows:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">AuthorizedItemResourceByUser</span><span class="p">(</span><span class="n">MyAuthorizedResource</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">UserItem</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'restrict_user_authorized_item'</span>
    <span class="n">needs_authorization</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">user_field_to_restrict_by</span> <span class="o">=</span> <span class="s">'boss'</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'name'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s">'user_id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">}</span>
</pre></div>

<h4>A more complicated example</h4>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Profile</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span><span class="s">'auth.User'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UserItem</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Profile</span><span class="p">)</span>
    <span class="n">is_active</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

<p>You should set <code>user_field_to_restrict_by="profile__user"</code> as follows:</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">AuthorizedItemResourceByUser</span><span class="p">(</span><span class="n">MyAuthorizedResource</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">UserItem</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'restrict_user_authorized_item'</span>
    <span class="n">needs_authorization</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">user_field_to_restrict_by</span> <span class="o">=</span> <span class="s">'profile__user'</span>

    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'name'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s">'user_id'</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">}</span>
</pre></div>

<p>Now when someone makes an authorized request, the results will be limited to the results that they own.</p>

<h1>Bend EasyRest to Your Will<a name="bend-easyrest-to-your-will"> </a>
</h1>

<p>Here are some facts.</p>

<ul>
<li>EasyRest is 160 lines of code.</li>
<li>You may have custom needs for your API.</li>
<li>If you read the source code, you'll know how to extend EasyRest to suit your needs.</li>
</ul><h4>My Recommendations</h4>

<p>Whether you want to change the url schema, add more CRUD methods, or change the way data is retrieved,
always feel free to subclass <code>easyrest.API</code>, <code>easyrest.APIResource</code>, and the <code>ListView</code> and <code>ItemView</code> to your heart's desire.</p>

<p>Let me know how you extend EasyRest, I'd be excited to learn and potentially get some pull requests!</p>

<h1>How to Hack on EasyRest<a name="how-to-hack-on-easyrest"> </a>
</h1>

<ol>
<li>git clone this repo</li>
<li>create a virtualenv and install the requirements via <code>pip install -r requirements.txt</code>
</li>
<li>under /tests, run <code>python manage.py syncdb</code>
</li>
<li>to run the tests, in the root directory run <code>make test</code>
</li>
</ol><p>Happy hacking!</p>

<h1>Roadmap<a name="roadmap"> </a>
</h1>

<ul>
<li>I'm thinking about whether to support the other CRUD operations.</li>
<li>Javascript Framework template tags so that when setting up Backbone sync for example, all you have to do is something like {% backbone mymodel %}{% endbackbone %} and your endpoints are already set up.</li>
</ul><p>If you have any suggestions, please let me know.</p>

<h1>License<a name="license"> </a>
</h1>

<p>(The MIT license)</p>

<p>Copyright (c) 2013 Suneel Chakravorty <a href="mailto:suneel0101@gmail.com">suneel0101@gmail.com</a></p>

<p>Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:</p>

<p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>