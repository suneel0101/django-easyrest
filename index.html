<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Django-restroom : A super lightweight django REST api framework" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Django-restroom</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/suneel0101/django-restroom">View on GitHub</a>

          <h1 id="project_title">Django-restroom</h1>
          <h2 id="project_tagline">A super lightweight django REST api framework</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/suneel0101/django-restroom/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/suneel0101/django-restroom/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>Django-Restroom: a super lightweight REST API framework</h1>

<h3>Status: This project is still under development!</h3>

<p>Whether you want to create an API for your product for external consumption or you just want to expose a REST API for your own frontend application, Django-Restroom is an incredibly easy and fast way to accomplish that.
You just register your models and include the restroom urls.</p>

<p>There are also additional features such as authentication, pagination and the ability to restrict a resource to return results owned by the requesting user.</p>

<h2>1. Register your models</h2>

<p>Basic Usage:</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">MyModel</span>
<span class="kn">from</span> <span class="nn">restroom.core</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">API</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyModel</span><span class="p">)</span>
</pre></div>

<p>This enables GET requests to the RESTful endpoints for the resource <code>MyModel</code>.
GET requests will return serialized results with all of the fields of the model.</p>

<p>However, <code>register</code> does take an options dictionary with the following parameters:</p>

<h3><code>http_methods</code></h3>

<p>These are the HTTP methods of requests you want to enable for that model resource.
You can pass in any sublist of ["GET", "POST", "DELETE", "PUT"]
If you do not pass in anything, it will default to only allowing GET requests.</p>

<p>Sample Usage:</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">MyModel</span>
<span class="kn">from</span> <span class="nn">restroom.core</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">API</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="p">{</span><span class="s">"http_methods"</span><span class="p">:</span> <span class="p">[</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"POST"</span><span class="p">,</span> <span class="s">"PUT"</span><span class="p">]})</span>
</pre></div>

<p>Any <code>DELETE</code> requests to the RESTful endpoints for <code>MyModel</code> will return an empty 403 response forbidden.</p>

<h3><code>fields</code></h3>

<p>These are the fields of the model you want to expose to consumers of your api.
The object's <code>id</code> will always be exposed. If you do not pass in anything, it will default to exposing all fields.
When the REST endpoints for a model are requested by any method other than the ones you have allowed, a 403 Forbidden response will be returned.</p>

<p>Sample usage:</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">restroom.core</span> <span class="kn">import</span> <span class="n">api</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">API</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">date_published</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>

<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="p">{</span><span class="s">"fields"</span><span class="p">:</span> <span class="p">[</span><span class="s">"title"</span><span class="p">,</span> <span class="s">"author"</span><span class="p">]})</span>
</pre></div>

<p>The results will be serialized so that only the <code>id</code>, <code>title</code>, <code>author</code> fields are in the return JSON.</p>

<p>There are two additional optional parameters <code>needs_auth</code> and <code>only_for_user</code> which will be discussed in the Authentication section.</p>

<h3>Recommended pattern of registering your models</h3>

<p>It's easiest to the do following, although after using this library just once, you'll feel comfortable enough to register your models however and wherever you'd like.</p>

<p>In the same level as your main urlconf, create a file <code>api.py</code>
In <code>api.py</code>:</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">restroom.core</span> <span class="kn">import</span> <span class="n">API</span>
<span class="kn">from</span> <span class="nn">apps.thisapp.models</span> <span class="kn">import</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<span class="kn">from</span> <span class="nn">apps.otherapp.models</span> <span class="kn">import</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span>
<span class="o">...</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">API</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">{</span><span class="s">"fields"</span><span class="p">:</span> <span class="p">[</span><span class="s">"text"</span><span class="p">,</span> <span class="s">"slug"</span><span class="p">]})</span>
<span class="n">api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="p">{</span><span class="s">"http_methods"</span><span class="p">:</span> <span class="p">[</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"POST"</span><span class="p">]})</span>
<span class="o">...</span>
</pre></div>

<h2>2. Include urls in your main urlconf</h2>

<p>Follow the above recommended pattern models. Then your main urls.py</p>

<div class="highlight"><pre><span class="kn">from</span> <span class="nn">.api</span> <span class="kn">import</span> <span class="n">api</span>
<span class="o">...</span>
<span class="n">urlpatterns</span> <span class="o">+=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">url</span><span class="p">(</span><span class="s">'r^api/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">get_urls</span><span class="p">())))</span>
</pre></div>

<h2>3. REST endpoints are created automatically</h2>

<p>Suppose you have registered the model <code>EmailRecord</code> from the app <code>emailer</code> with <code>http_methods=['GET', 'POST', 'DELETE', 'PUT']</code> and the <code>fields=['user', 'timestamp', 'body']</code>.
Then you have included the urls under the prefix <code>/api/</code> as above.</p>

<p>Then these are the REST endpoints you can request:</p>

<h3>/api/emailer_emailrecord/</h3>

<ul>
<li>This is a list resource.</li>
<li>GET will return a list of results which match the query.</li>
<li>PUT will modify all results that match the query.</li>
<li>POST will create a new object.</li>
<li>DELETE is always forbidden.</li>
</ul><h3>/api/emailer_emailrecord/{int: id}/</h3>

<ul>
<li>This is an item resource.</li>
<li>GET will return the object with that id.</li>
<li>PUT will modify the object.</li>
<li>DELETE will delete the object.</li>
<li>POST is always forbidden.</li>
</ul><h2>4. Format of Requests and Responses</h2>

<h3>GET /api/emailer_emailrecord/</h3>

<p>Responds with a list of all <code>EmailRecord</code> objects, for example:</p>

<pre><code>HTTP 200
{
    "items": [
        {"id": 1,
         "body": "Dear sir, will you sign up for my site?",
         "timestamp": "2013-03-15T20:56:13.652681"},
        {"id": 2,
         "body": "Dear miss, will you sign up for my site?",
         "timestamp": "2013-03-16T20:33:19.952455"},
        {"id": 3,
         "body": "Dear friend, will you sign up for my site?",
         "timestamp": "2013-03-18T16:14:21.322591"}
    ]  
}

</code></pre>

<h3>GET /api/emailer_emailrecord/?q={{ query }}</h3>

<p>Responds with a list of all <code>EmailRecord</code> objects that fit the query parameters. See the Querying API for more information.</p>

<p><code>GET /api/emailer_emailrecord/?q=[{"field": "id", "operator": "in", value": [1,3]}]</code> would return the following:</p>

<pre><code>HTTP 200
{
    "items": [
        {"id": 1,
         "body": "Dear sir, will you sign up for my site?",
         "timestamp": "2013-03-15T20:56:13.652681"},
        {"id": 3,
         "body": "Dear friend, will you sign up for my site?",
         "timestamp": "2013-03-18T16:14:21.322591"}
    ]  
}

</code></pre>

<h3>GET /api/emailer_emailrecord/{int: id}</h3>

<p>Returns <code>EmailRecord</code> with <code>id: 1</code>, so <code>GET /api/emailer_emailrecord/1/</code> would return the following:</p>

<pre><code>HTTP 200
{
    "id": 1,
    "body": "Dear sir, will you sign up for my site?",
    "timestamp": "2013-03-15T20:56:13.652681"
}
</code></pre>

<p>If you try to GET for an id that does not correspond to any <code>EmailRecord</code>, for example <code>GET /api/emailer_emailrecord/5/</code>, you will get:</p>

<pre><code>HTTP 400
{
    "error": "No result found matching id: 5"
}
</code></pre>

<h3>DELETE /api/emailer_emailrecord/{int: id}</h3>

<p>Deletes <code>EmailRecord</code> with <code>id: 1</code>, so <code>GET /api/emailer_emailrecord/1/</code> would return the following:</p>

<pre><code>HTTP 204 No Content
</code></pre>

<p>If you try to DELETE for an id that does not correspond to any <code>EmailRecord</code>, for example <code>GET /api/emailer_emailrecord/5/</code>, you will get:</p>

<pre><code>HTTP 400
{
    "error": "No result found matching id: 5"
}
</code></pre>

<h3>POST /api/emailer_emailrecord/</h3>

<p>Creates a new <code>EmailRecord</code> with from the JSON POST data.</p>

<p>Here is an example request:</p>

<pre><code>POST /api/emailer_emailrecord/
{
    "data": {
        "body": "New email body"
        "timestamp": "2013-01-01T12:00:00",
    }
}
</code></pre>

<p>Here would be the response:</p>

<pre><code>HTTP 201
{
    "id": 3,
    "body": "New email body"
    "timestamp": "2013-01-01T12:00:00",
}
</code></pre>

<p>If you send in the data dictionary any fields that are not on the model, or if the the data that you are creating is not valid by some database constraints, column uniqueness for example, then you will get a 400 error with an error JSON message.</p>

<p>For example,</p>

<pre><code>POST /api/emailer_emailrecord/
{
    "data": {
        "crazybody": "blahblahblah"
        "timestamp": "2013-01-01T12:00:00",
    }
}
</code></pre>

<pre><code>HTTP 400
{
    "error": "Cannot resolves the following field names: crazybody"
}
</code></pre>

<h2>5. Querying API</h2>

<h2>6. Authentication</h2>

<h2>7. Restricting resources by user</h2>

<h2>8. Data Serialization</h2>

<h2>9. Pagination</h2>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Django-restroom maintained by <a href="https://github.com/suneel0101">suneel0101</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
